<!-- 12/8 -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Add Company Form - Laravel 8 CRUD</title>



    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" rel="stylesheet">

    <!-- CKEditor script from CDN -->
    <script src="https://cdn.ckeditor.com/ckeditor5/39.0.1/classic/ckeditor.js"></script>

    <!-- Include jQuery before Bootstrap's JavaScript -->
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>

    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />
    <style>
        .pull-right {
            text-align: right;
        }
    </style>
</head>

<body>

    <div class="container mt-2">

        <div class="row">
            <div class="col-lg-12 margin-tb">
                <div class="pull-left mb-2">
                    <h2 class="text-center">Add Productss</h2>
                </div>
                <div class="pull-right">
                    <a class="btn btn-primary" href="{{ route('Products.index') }}"> Back</a>
                </div>
            </div>
        </div>

        @if (session('status'))
            <div class="alert alert-success mb-1 mt-1">
                {{ session('status') }}
            </div>
        @endif




        <form action="{{ route('Products.store') }}" method="POST" enctype="multipart/form-data"
            id="my-awesome-dropzone" class="dropzone">



            @csrf

            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">
                        <strong>Products Name:</strong>
                        <input type="text" name="name" class="form-control" placeholder="Products Name">

                    </div>
                </div>

                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">
                        <strong>Products Description:</strong>
                        <div id="editor">This is some sample content.</div>
                        <textarea name="description" style="display: none;"></textarea> <!-- Hidden textarea for CKEditor content -->

                    </div>
                </div>
                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">
                        <strong>Products Status:</strong>
                        <label>
                            <input type="radio" name="status" value="0" checked> Active
                        </label>
                        <label>
                            <input type="radio" name="status" value="1"> Inactive
                        </label>
                    </div>
                </div>

                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="form-group">
                        <strong>Products img:</strong>

                        <input type="file" name="images[]" multiple />
                    </div>
                </div>



                {{-- <button type="submit" id="submitBtn" class="btn btn-primary ml-3">Submit</button> --}}


                <button type="submit" id="button" class="btn btn-primary ml-3">Submit</button>
            </div>

        </form>


    </div>

    <script>
        Dropzone.options.frmTarget = {
            autoProcessQueue: false,
            url: "{{ route('Products.store') }}",
            init: function() {

                var myDropzone = this;

                // Update selector to match your button
                $("#button").click(function(e) {
                    e.preventDefault();
                    myDropzone.processQueue();
                });

                this.on('sending', function(file, xhr, formData) {
                    // Append all form inputs to the formData Dropzone will POST
                    var data = $('#frmTarget').serializeArray();
                    $.each(data, function(key, el) {
                        formData.append(el.name, el.value);
                    });
                });
            }
        }
    </script>


    <script>
        ClassicEditor
            .create(document.querySelector('#editor'))
            .then(editor => {
                console.log(editor);

                // Update the hidden textarea with CKEditor content before form submission
                editor.model.document.on('change:data', () => {
                    document.querySelector('textarea[name="description"]').value = editor.getData();
                });
            })
            .catch(error => {
                console.error(error);
            });
    </script>

    <script type="text/javascript">
        Dropzone.options.imageUpload = {
            maxFilesize: 1,
            acceptedFiles: ".jpeg,.jpg,.png,.gif"
        };
    </script>

</body>

</html>
